---
title: Configuration(TOTP)
---

This guide covers the Time-based One Time Password Multi Factor Authentication configuration for your Protekt application. 

## Before You Begin
- You must have an active [Protekt account](/getting-started/setting-up-account) and a [configured project](/getting-started//quick-start/nextjs).

- Email Verification is required for TOTP. Ensure your Email Verification Flow is configured and enabled before proceeding.

- TOTP is a free MFA method. There are no additional costs for enabling or using authenticator apps with Protekt.

## Dashboard Configuration
To configure TOTP in your application, you must enable the TOTP Authentication. 
<Steps>
  <Step title="Navigate to Multi-Factor Authentication settings">
    Go to **Multi-Factor Authentication** settings in your **Protekt Dashboard**.
    

  </Step>

  <Step title="Enable Authenticator Apps">
    Toggle **Authenticator Apps (TOTP)** to enabled.
    ![TOTP](/images/TOTP-Configuration.png)
    

  </Step>

  <Step title="Configure time window tolerance">
    **Time Window Tolerance:** Allows codes from up to 5 time intervals (2.5 minutes) before/after current time to account for clock drift between user device and server. Higher values are more forgiving but less secure.
    
    - **Default: 5 intervals** - Accepts codes from 2.5 minutes before/after current time
    - **Range: 1-10 intervals** - 1 = 30 seconds tolerance, 10 = 5 minutes tolerance
    - **Recommendation: 5** - Good balance of security and usability

    ![TOTP](/images/interval.png)

  </Step>

  <Step title="Save your changes">
    Click **Save Changes** to apply the configuration.
    
    
  </Step>
</Steps>

After enabling TOTP in the dashboard, the next step is to configure your application's environment to communicate with Protekt.


## Configure Environment Variables
In your project, create an `.env.local` file and add this TOTP-specific configuration to the environment:
**File:** `.env.local`

```bash
# Enable TOTP strategy
PROTEKT_MFA_TOTP_ENABLED=true

# Optional: Custom app name for authenticator apps  
PROTEKT_MFA_APP_NAME="Your App Name"

# Optional: Time window tolerance (1-10, default is 5)
PROTEKT_MFA_TIME_TOLERANCE=5
```

## Update Your App Provider

**File:** `src/app/layout.tsx` (Next.js App Router) or `pages/_app.tsx` (Pages Router)

Configure your application to support TOTP authentication:

```tsx
import { ProtektProvider } from '@protekt/nextjs'

export default function App({ children }) {
  return (
    <ProtektProvider
      mfa={{
        // Define the MFA strategies you want to enable for your app.
        // 'backup_codes' are recommended as a fallback.
        strategies: ['totp', 'backup_codes'],

        // MFA requirement setting:
        // required: false - MFA is optional, users choose to enable it (recommended for most apps)
        // required: true - All users must enable MFA after registration (high-security applications)
        required: false
      }}
    >
      {children}
    </ProtektProvider>
  )
}
```

## Choose Enrollment Pattern

Select when users can enable TOTP authentication by updating your provider configuration:

**Optional MFA (Recommended for most applications):**
```tsx
<ProtektProvider mfa={{ required: false, prompt: 'optional' }}>
```
- Users can enable MFA from their account settings
- No forced enrollment during registration
- Good for consumer applications and gradual security rollouts

**Required MFA (High-security applications):**
```tsx  
<ProtektProvider mfa={{ required: true, strategies: ['totp'] }}>
```
- All users must enable MFA immediately after registration
- Blocks access until MFA is configured
- Ideal for financial, or sensitive data applications

## Test Your Configuration

Start your development server and verify TOTP is available:

```bash
npm run dev
```

Navigate to your app and check that MFA options appear in user settings or registration flow.

## Next Steps

ðŸŽ‰ Backend configuration complete! Now, follow the [frontend integration guide](/mfa/totp/frontend-integration) to build the user-facing components that allow users to enroll with their authenticator app.